#!/bin/bash
#
# tangle markdown literate-programming files
#
# awk snippet taken from
#
# https://gist.github.com/trauber/4955706


function tangle () {
    MDFILE=$1

    # Get line containing tangle filename
    FOUT=`gawk 'match($0, /^\[\:tangle (.*)\]/, a) {print a[1]}' ${MDFILE}`

    echo $FOUT

    echo ""
    printf "\033[0;33mtangling ${MDFILE} -> ${FOUT}...\033[0m \n"

    # tangle file
    gawk '{ if (/^```/) { i++; next } if ( i % 2 == 1) { print } }' ${MDFILE} > ${FOUT}
}


tangle spacemacs.md
